---
import "../styles/global.css";
import ProductList from "../components/ProductList";
import PriceFilter from "../components/PriceFilter";
import NameSearchFilter from "../components/NameSearchFilter.vue";
import CategoryFilter from "../components/CategoryFilter.svelte";

const res = await fetch('https://fakestoreapi.com/products');
const products = await res.json();

const minPrice = Math.floor(Math.min(...products.map((p: any) => p.price)));
const maxPrice = Math.ceil(Math.max(...products.map((p: any) => p.price)));

const categories = [...new Set(products.map((p: any) => p.category))];

interface Product {
  id: number;
  title: string;
  price: number;
  image: string;
  description: string;
  category: string;
}
---

<html lang="es">
  <head>
    <title>Mi E-commerce</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
  </head>
  <body class="p-8 bg-gray-100 min-h-screen">
    <div class="container mx-auto max-w-7xl">
      <h1 class="text-4xl font-bold mb-6">Cat√°logo de Productos</h1>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        <div class="md:col-span-1">
          <PriceFilter client:load minPrice={minPrice} maxPrice={maxPrice} />
          <NameSearchFilter client:load />
          <CategoryFilter client:load categories={categories} />
        </div>
        <div class="md:col-span-3">
          <ProductList client:load initialProducts={products} />
        </div>
      </div>
    </div>
  </body>
</html>